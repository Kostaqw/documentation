<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Руководство пользователя</title>
    <link href="../lib/bootstrap.min.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">

</head>
<header>
    <div class="container-fluid bg-primary text-white py-2">
        <div class="row align-items-center">
            <div class="col-auto">
                <img src="../img/cmake-logo-16.png" alt="Logo" class="img-fluid" style="max-height: 40px;">
            </div>
            <div class="col">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb bg-primary text-white mb-0">
                        <li class="breadcrumb-item"><a href="../index.html" class="text-white">Документация</a></li>
                        <li class="breadcrumb-item"><a href="#" class="text-white">Руководства по взаимодействию с пользователем</a></li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</header>

<body>
    <div class="container">
        <div class="container mt-5">
            <h1 class="section-title">Руководство пользователя</h1>
            <ul>
                <li>
                    <h4><a href="#introdution">Введение</a></h4>
                </li>
                <li>
                    <h4><a href="#genBuild">Создание системы сборки</a></h4>
                </li>
                <li>
                    <h4><a href="#setVar">Настройка переменных сборки</a></h4>
                </li>
                <li>
                    <h4><a href="#presets">Предустановки</a></h4>
                </li>
                <li>
                    <h4><a href="#buildInvoke">Вызов системы сборки</a></h4>
                </li>
                <li>
                    <h4><a href="#setup">Установка Программного Обеспечения</a></h4>
                </li>
                <li>
                    <h4><a href="#test">Запуск тестов</a></h4>
                </li>
            </ul>

            <h2 id="introdution" class="section-title">Введение</h2>
            <p>
                Когда программное обеспечение предоставляет систему сборки на основе CMake вместе с исходным кодом,
                пользователь должен использовать инструмент взаимодействия с CMake для его сборки.
            </p>
            <p>
                Правильно настроенные системы сборки на основе CMake не создают никаких выходных данных в каталоге
                исходного кода, поэтому пользователь обычно выполняет сборку за пределами исходного каталога.
                Сначала CMake должен быть настроен на генерацию подходящей системы сборки, а затем пользователь
                вызывает инструмент сборки для обработки сгенерированной системы сборки. Сгенерированная система
                сборки специфична для машины, на которой она была создана, и не подлежит распространению. Каждый
                пользователь исходного программного пакета должен использовать CMake для генерации системы сборки,
                специфичной для его системы.
            </p>
            <p>
                Сгенерированные системы сборки, как правило, следует считать только для чтения. Файлы CMake как
                основные артефакты должны полностью определять систему сборки, и не должно быть необходимости
                вручную заполнять свойства, например, в IDE после генерации системы сборки. CMake периодически
                перезаписывает сгенерированную систему сборки, поэтому изменения, внесенные пользователями, будут
                перезаписаны.
            </p>
            <p>
                Описанные в данном руководстве функции и пользовательские интерфейсы доступны для всех систем сборки
                на основе CMake благодаря предоставлению файлов CMake.
            </p>
            <p>
                Инструменты CMake могут сообщать об ошибках пользователю при обработке предоставленных файлов CMake,
                таких как сообщение о том, что компилятор не поддерживается или компилятор не поддерживает
                необходимую опцию компиляции, или зависимость не может быть найдена. Эти ошибки должны быть
                устранены пользователем путем выбора другого компилятора, <a href="UsingDependenciesGuide.html">установки зависимостей</a> или указания CMake,
                где их найти и т.д.
            </p>

            <h2 id="clt" class="section-title">Инструменты командной строки для cmake</h2>
            <p>
                Простой, но типичный пример использования <a href="../CommandLineTools/cmake.html">cmake(1)</a> с новой копией исходного кода программного
                обеспечения - это создание каталога сборки и вызов cmake в нем:
            </p>

            <pre><code>$ cd some_software-1.4.2 <br>$ mkdir build<br>$ cd build<br>$ cmake .. -DCMAKE_INSTALL_PREFIX=/opt/the/prefix<br>$ cmake --build .<br>$ cmake --build . --target install</code></pre>

            <p>
                Рекомендуется выполнять сборку в отдельном каталоге от исходного, так как это сохраняет исходный
                каталог нетронутым, позволяет выполнять сборку с использованием нескольких цепочек инструментов и
                позволяет легко очистить артефакты сборки, просто удалив каталог сборки.
            </p>
            <p>
                Инструменты CMake могут сообщать предупреждения, предназначенные для разработчиков программного
                обеспечения, а не для пользователей. Такие предупреждения заканчиваются фразой "Это предупреждение
                для разработчиков проекта". Пользователи могут отключить такие предупреждения, передав флаг -Wno-dev
                команде <a href="../CommandLineTools/cmake.html">cmake(1)</a>.
            </p>

            <h2 id="gt" class="section-title">Графические инструменты </h2>
            <p>
                Пользователи, предпочитающие интерфейсы на основе графического интерфейса, могут использовать
                инструмент <a href="../InteractiveDialogs/cmake-gui.html">cmake-gui</a> для вызова CMake и генерации системы сборки.
            </p>
            <p>
                Сначала необходимо заполнить каталоги исходного кода и двоичных файлов. Всегда рекомендуется
                использовать разные каталоги для исходного кода и сборки.
            </p>

            <img src="../img/GUI-Source-Binary.png" class="img-fluid">

            <h2 id="genBuild" class="section-title">Создание системы сборки</h2>
            <p>
                Существует несколько инструментов пользовательского интерфейса, которые могут быть использованы для
                генерации системы сборки из файлов CMake. Инструменты <a href="../InteractiveDialogs/ccmake.html">ccmake</a> и <a href="../InteractiveDialogs/cmake-gui.html">cmake-gui</a> помогают пользователю
                настроить различные необходимые опции. Инструмент <a href="../CommandLineTools/cmake.html">cmake</a> может быть вызван для указания опций
                через командную строку. В данном руководстве описаны опции, которые можно установить с помощью
                любого из пользовательских интерфейсов, хотя способ установки опции различен для каждого
                инструмента.
            </p>
            <h4 class="section-title">Среда командной строки</h4>
            <p>
                При вызове <a href="../CommandLineTools/cmake.html">cmake</a> с использованием системы сборки командной строки, такой как
                Makefiles или Ninja, необходимо использовать правильную среду сборки, чтобы убедиться, что
                инструменты сборки доступны. CMake должен иметь возможность найти соответствующий инструмент сборки,
                компилятор, компоновщик и другие необходимые инструменты.
            </p>
            <p>
                В системах Linux соответствующие инструменты часто предоставляются в системных каталогах и могут
                быть легко установлены через системный менеджер пакетов. Другие цепочки инструментов,
                предоставляемые пользователем или установленные в нестандартных каталогах, также могут быть
                использованы.
            </p>
            <p>
                При кросс-компиляции некоторые платформы могут требовать установки переменных окружения или
                предоставлять скрипты для их настройки.
            </p>
            <p>
                Visual Studio поставляется с несколькими командными оболочками и скриптами
                <code>vcvarsall.bat</code> для настройки правильной среды для систем сборки командной строки. Хотя
                не обязательно использовать соответствующую среду командной строки при использовании генератора
                Visual Studio, это не имеет недостатков.
            </p>
            <p>
                При использовании Xcode может быть установлено несколько версий Xcode. Выбор версии можно
                осуществить несколькими способами:
            </p>
            <ul>
                <li>Установить версию по умолчанию в настройках IDE Xcode.</li>
                <li>Установить версию по умолчанию через командную строку с помощью инструмента
                    <code>xcode-select</code>.
                </li>
                <li>Переопределить версию по умолчанию, установив переменную окружения <code>DEVELOPER_DIR</code>
                    при запуске CMake и инструмента сборки.</li>
            </ul>
            <p>Для удобства <code>cmake-gui(1)</code> предоставляет редактор переменных окружения.</p>

            <h4 class="section-title">Опция командной строки -G</h4>
            <p>
                CMake выбирает генератор по умолчанию в зависимости от платформы. Обычно генератор по умолчанию
                достаточен, чтобы позволить пользователю приступить к сборке программного обеспечения.
            </p>
            <p>
                Пользователь может переопределить генератор по умолчанию с помощью опции <code>-G</code>:
            </p>
            <pre><code>cmake .. -G Ninja</code></pre>
            <p>
                Вывод <code>cmake --help</code> включает список генераторов, доступных для выбора пользователем.
                Обратите внимание, что названия генераторов чувствительны к регистру.
            </p>
            <p>
                В Unix-подобных системах (включая Mac OS X) по умолчанию используется генератор Unix Makefiles.
                Вариант этого генератора также может быть использован на Windows в различных средах, таких как NMake
                Makefiles и MinGW Makefiles. Эти генераторы создают вариант Makefile, который может быть выполнен с
                помощью <code>make</code>, <code>gmake</code>, <code>nmake</code> или аналогичных инструментов.
                Подробности о целевых средах и инструментах см. в документации по отдельным генераторам.
            </p>
            <p>
                Генератор Ninja доступен на всех основных платформах. <code>ninja</code> — это инструмент сборки,
                аналогичный <code>make</code>, но с упором на производительность и эффективность.
            </p>
            <p>
                На Windows <code>cmake(1)</code> может использоваться для генерации решений для IDE Visual Studio.
                Версии Visual Studio могут быть указаны по названию продукта IDE, которое включает четырехзначный
                год. Предусмотрены псевдонимы для других способов, которыми иногда называются версии Visual Studio,
                такие как двухзначные цифры, соответствующие версии продукта VisualC++, или их комбинация:
            </p>
            <pre><code>cmake .. -G "Visual Studio 2019"</code></pre>
            <pre><code>cmake .. -G "Visual Studio 16"</code></pre>
            <pre><code>cmake .. -G "Visual Studio 16 2019"</code></pre>
            <p>
                Генераторы Visual Studio могут ориентироваться на разные архитектуры. Можно указать целевую
                архитектуру с помощью опции <code>-A</code>:
            </p>
            <pre><code>cmake .. -G "Visual Studio 2019" -A x64</code></pre>
            <pre><code>cmake .. -G "Visual Studio 16" -A ARM</code></pre>
            <pre><code>cmake .. -G "Visual Studio 16 2019" -A ARM64</code></pre>
            <p>
                На Apple можно использовать генератор Xcode для создания файлов проектов для IDE Xcode.
            </p>
            <p>
                Некоторые IDE, такие как KDevelop4, QtCreator и CLion, имеют встроенную поддержку систем сборки на
                основе CMake. Эти IDE предоставляют интерфейс для выбора используемого генератора, обычно между
                генератором на основе Makefile или Ninja.
            </p>
            <p>
                Обратите внимание, что невозможно изменить генератор с помощью <code>-G</code> после первого вызова
                CMake. Для изменения генератора необходимо удалить каталог сборки и начать сборку с нуля.
            </p>
            <p>
                При генерации файлов проектов и решений Visual Studio доступны несколько других опций для
                использования при первоначальном запуске <code><a href="">cmake(1)</a></code>.
            </p>
            <p>
                Инструментарий Visual Studio можно указать с помощью опции <code>cmake -T</code>:
            </p>
            <pre><code># Сборка с использованием инструментов clang-cl<br>cmake.exe .. -G "Visual Studio 16 2019" -A x64 -T ClangCL</code></pre>
            <pre><code># Сборка с целевым назначением Windows XP<br>cmake.exe .. -G "Visual Studio 16 2019" -A x64 -T v120_xp</code></pre>
            <p>
                В то время как опция <code>-A</code> указывает целевую архитектуру, опция <code>-T</code> может быть
                использована для указания деталей используемой цепочки инструментов. Например, можно передать
                <code>-Thost=x64</code>, чтобы выбрать 64-разрядную версию инструментов хоста. Следующий пример
                демонстрирует, как использовать 64-битные инструменты и также собирать для целевой архитектуры
                64-бита:
            </p>
            <pre><code>cmake .. -G "Visual Studio 16 2019" -A x64 -Thost=x64</code></pre>

            <h4 class="section-title">Выбор генератора через GUI</h4>
            <p>Кнопка «Configure» открывает новое диалоговое окно для выбора генератора CMake.</p>
            <img src="../img/GUI-Configure-Dialog.png" class="img-fluid">
            <p>Все генераторы, доступные в командной строке, также доступны в <a href="">cmake-gui(1).</a></p>
            <img src="../img/GUI-Choose-Generator.png" class="img-fluid">
            <p>При выборе генератора Visual Studio доступны дополнительные параметры для установки целевой архитектуры.</p>
            <img src="../img/VS-Choose-Arch.png" class="img-fluid">

            <h2 id="setVar" class="section-title">Установка переменных сборки</h2>

            <p>Программные проекты часто требуют установки переменных через командную строку при вызове CMake. Некоторые из наиболее часто используемых переменных CMake перечислены в таблице ниже:</p>
            <table>
                <thead>
                    <tr>
                        <th>Переменная</th>
                        <th>Значение</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code><a href="">CMAKE_PREFIX_PATH</a></code></td>
                        <td>Путь для поиска <a href="">зависимых пакетов</td>
                    </tr>
                    <tr>
                        <td><code><a href="">CMAKE_MODULE_PATH</a></code></td>
                        <td>Путь для поиска дополнительных модулей CMake</td>
                    </tr>
                    <tr>
                        <td><code><a href="">CMAKE_BUILD_TYPE</a></code></td>
                        <td>Конфигурация сборки, такая как Debug или Release, определяющая флаги отладки/оптимизации. Это имеет значение только для одноконфигурационных систем сборки, таких как Makefile и Ninja. Многоконфигурационные системы сборки, такие как Visual Studio и Xcode, игнорируют эту настройку.</td>
                    </tr>
                    <tr>
                        <td><code><a href="">CMAKE_INSTALL_PREFIX</a></code></td>
                        <td>Место для установки программного обеспечения с целью сборки install</td>
                    </tr>
                    <tr>
                        <td><code><a href="">CMAKE_TOOLCHAIN_FILE</a></code></td>
                        <td>Файл, содержащий данные для кросс-компиляции, такие как <a href="">наборы инструментов и sysroots.</a></td>
                    </tr>
                    <tr>
                        <td><code><a href="">BUILD_SHARED_LIBS</a></code></td>
                        <td>Флаг для сборки общих библиотек вместо статических для команд <code><a href="">add_library()</a></code>, используемых без указания типа.</td>
                    </tr>
                    <tr>
                        <td><code><a href="">CMAKE_EXPORT_COMPILE_COMMANDS</a></code></td>
                        <td>Генерация файла <code>compile_commands.json</code> для использования с инструментами на основе clang</td>
                    </tr>
                </tbody>
            </table>
        
            <p>Могут быть доступны и другие переменные, специфичные для проекта, для управления сборкой, такие как включение или отключение компонентов проекта.</p>
        
            <p>В CMake нет стандарта именования таких переменных между различными системами сборки, кроме того, что переменные с префиксом <code>CMAKE_</code> обычно относятся к параметрам, предоставляемым самим CMake, и не должны использоваться в сторонних параметрах, которые должны использовать собственный префикс. Инструмент <code>cmake-gui(1)</code> может отображать параметры в группах, определенных их префиксом, поэтому имеет смысл для сторонних разработчиков использовать согласованный префикс.</p>
        
            <h4 class="section-title">Установка переменных в командной строке</h4>
        
            <p>Переменные CMake могут быть установлены в командной строке как при создании первоначальной сборки:</p>
        
            <pre><code>mkdir build<br>cd build<br>cmake .. -G Ninja -DCMAKE_BUILD_TYPE=Debug</code></pre>
        
            <p>так и позже при последующем вызове cmake(1):</p>
        
            <pre><code>cd build<br>cmake . -DCMAKE_BUILD_TYPE=Debug</code></pre>
        
            <p>Флаг -U может быть использован для сброса переменных в командной строке cmake(1):</p>
        
            <pre><code>cd build<br>cmake . -UMyPackage_DIR</code></pre>
        
            <p>Система сборки CMake, которая была первоначально создана в командной строке, может быть изменена с использованием <code>cmake-gui(1)</code> и наоборот.</p>
        
            <p>Инструмент <code>cmake(1)</code> позволяет указать файл для использования при заполнении начального кэша с помощью опции -C. Это может быть полезно для упрощения команд и скриптов, которые требуют одних и тех же записей кэша несколько раз.</p>
        
            <h4 class="section-title">Установка переменных с помощью cmake-gui</h4>
        
            <p>Переменные могут быть установлены в cmake-gui с помощью кнопки "Add Entry". Это вызовет новое диалоговое окно для установки значения переменной.</p>
            <img src="../img/GUI-Add-Entry.png" class="img-fluid">

            <p>Основное окно пользовательского интерфейса <code>cmake-gui(1)</code> можно использовать для редактирования существующих переменных.</p>
        
            <h4 class="section-title">Кэш CMake</h2>

            <p>Когда выполняется CMake, ему необходимо найти расположение компиляторов, инструментов и зависимостей. Также важно, чтобы CMake мог повторно сгенерировать систему сборки с теми же флагами компиляции/линковки и путями к зависимостям. Эти параметры должны быть настроены пользователем, поскольку они специфичны для системы пользователя.</p>
        
            <p>При первом запуске CMake создает файл <code>CMakeCache.txt</code> в каталоге сборки, содержащий пары ключ-значение для таких артефактов. Этот файл кэша можно просматривать или редактировать, запустив инструмент <code>cmake-gui(1)</code> или <code>ccmake(1)</code>. Эти инструменты предоставляют интерактивный интерфейс для перенастройки предоставленного программного обеспечения и повторной генерации системы сборки после редактирования значений в кэше. Каждая запись в кэше может иметь связанный с ней краткий текст справки, который отображается в пользовательских интерфейсах инструментов.</p>
        
            <p>Записи кэша также могут иметь тип, указывающий, как они должны отображаться в пользовательском интерфейсе. Например, запись кэша типа <code>BOOL</code> может редактироваться с помощью флажка в пользовательском интерфейсе, <code>STRING</code> можно редактировать в текстовом поле, а <code>FILEPATH</code>, аналогично <code>STRING</code>, также должна предоставлять возможность указать путь к файлу с помощью диалога выбора файла. Запись типа <code>STRING</code> может предоставлять ограниченный список допустимых значений, которые затем отображаются в выпадающем меню в пользовательском интерфейсе <code>cmake-gui(1)</code> (см. свойство кэша <code>STRINGS</code>).</p>
        
            <p>Файлы CMake, поставляемые с программным пакетом, также могут определять булевы параметры с помощью команды <code>option()</code>. Эта команда создает запись в кэше, которая имеет текст справки и значение по умолчанию. Такие записи кэша обычно специфичны для предоставленного программного обеспечения и влияют на конфигурацию сборки, например, будут ли созданы тесты и примеры, будет ли сборка выполнена с включенными исключениями и т.д.</p>
        
            <h2 id="presets" class="section-title">Предустановки</h2>

            <p>CMake понимает файл <code>CMakePresets.json</code> и его пользовательский аналог <code>CMakeUserPresets.json</code> для сохранения предустановок для часто используемых настроек конфигурации. Эти предустановки могут устанавливать каталог сборки, генератор, переменные кэша, переменные среды и другие параметры командной строки. Все эти параметры могут быть переопределены пользователем. Полные детали формата <code>CMakePresets.json</code> приведены в руководстве <code>cmake-presets(7)</code>.</p>

            <h4 class="section-title">Использование предустановок в командной строке</h4>
            <p>При использовании инструмента командной строки <code>cmake(1)</code> предустановка может быть вызвана с помощью опции <code>--preset</code>. Если указана <code>--preset</code>, генератор и каталог сборки не обязательны, но могут быть указаны для их переопределения. Например, если у вас есть следующий файл <code>CMakePresets.json</code>:</p>
        
            <pre><code>{<br>          "version": 1,<br>          "configurePresets": [<br>            {<br>              "name": "ninja-release",<br>              "binaryDir": "${sourceDir}/build/${presetName}",<br>              "generator": "Ninja",<br>              "cacheVariables": {<br>                "CMAKE_BUILD_TYPE": "Release"<br>              }<br>            }]<br>        }</code></pre>

            <p>и вы выполните следующее:</p>

            <pre><code>cmake -S /path/to/source --preset=ninja-release</code></pre>
        
            <p>Это создаст каталог сборки в <code>/path/to/source/build/ninja-release</code> с генератором Ninja и с установленным значением <code>CMAKE_BUILD_TYPE</code> в Release.</p>
        
            <p>Если вы хотите увидеть список доступных предустановок, вы можете выполнить:</p>
        
            <pre><code>cmake -S /path/to/source --list-presets</code></pre>
        
            <p>Это отобразит предустановки, доступные в <code>/path/to/source/CMakePresets.json</code> и <code>/path/to/source/CMakeUsersPresets.json</code>, без генерации дерева сборки.</p>
        
            <h4 class="section-title">Использование предустановок в cmake-gui</h4>
            <p>Если проект имеет доступные предустановки, либо через <code>CMakePresets.json</code>, либо через <code>CMakeUserPresets.json</code>, список предустановок появится в выпадающем меню в <code>cmake-gui(1)</code> между каталогом исходного кода и каталогом сборки. Выбор предустановки устанавливает каталог сборки, генератор, переменные среды и переменные кэша, но все эти параметры могут быть переопределены после выбора предустановки.</p>
        
            <h2 id="buildInvoke" class="section-title">Вызов системы сборки</h2>
        
            <p>После генерации системы сборки программное обеспечение можно собрать, вызвав соответствующий инструмент сборки. В случае генераторов IDE это может включать загрузку сгенерированного файла проекта в IDE для выполнения сборки.</p>
        
            <p>CMake знает о конкретном инструменте сборки, необходимом для выполнения сборки, поэтому обычно, чтобы собрать систему сборки или проект из командной строки после генерации, можно выполнить следующую команду в каталоге сборки:</p>
        
            <pre><code>cmake --build .</code></pre>
        
            <p>Флаг <code>--build</code> включает определенный режим работы для инструмента <code>cmake(1)</code>. Он вызывает команду <code>CMAKE_MAKE_PROGRAM</code>, связанную с генератором, или инструмент сборки, настроенный пользователем.</p>
        
            <p>Режим <code>--build</code> также принимает параметр <code>--target</code> для указания конкретной цели для сборки, например, конкретной библиотеки, исполняемого файла или пользовательской цели, или конкретной специальной цели, такой как установка:</p>
        
            <pre><code>cmake --build . --target myexe</code></pre>
        
            <p>Режим <code>--build</code> также принимает параметр <code>--config</code> в случае многоконфигурационных генераторов для указания конкретной конфигурации для сборки:</p>
        
            <pre><code>cmake --build . --target myexe --config Release</code></pre>
        
            <p>Опция <code>--config</code> не оказывает влияния, если генератор генерирует систему сборки, специфичную для конфигурации, которая выбирается при вызове cmake с переменной <code>CMAKE_BUILD_TYPE</code>.</p>
        
            <p>Некоторые системы сборки опускают детали командных строк, вызванных во время сборки. Флаг <code>--verbose</code> можно использовать для отображения этих командных строк:</p>
        
            <pre><code>cmake --build . --target myexe --verbose</code></pre>
        
            <p>Режим <code>--build</code> также может передавать определенные параметры командной строки в основной инструмент сборки, перечисляя их после <code>--</code>. Это может быть полезно для указания параметров инструменту сборки, например, чтобы продолжить сборку после неудачной задачи, где CMake не предоставляет интерфейс высокого уровня.</p>
        
            <p>Для всех генераторов возможно запускать основной инструмент сборки после вызова CMake. Например, make можно выполнить после генерации с помощью генератора Unix Makefiles для запуска сборки, или ninja после генерации с помощью генератора Ninja и т.д. Системы сборки IDE обычно предоставляют командные инструменты для сборки проекта, которые также можно вызвать.</p>
        
            <h4 class="section-title">Выбор цели</h4>
            <p>Каждый исполняемый файл и библиотека, описанные в файлах CMake, являются целями сборки, и система сборки может описывать пользовательские цели, как для внутреннего использования, так и для использования пользователем, например, для создания документации.</p>
        
            <p>CMake предоставляет несколько встроенных целей для всех систем сборки, предоставляющих файлы CMake:</p>
        
            <ul>
                <li><strong>all</strong> - Цель по умолчанию, используемая генераторами Makefile и Ninja. Собирает все цели в системе сборки, кроме тех, которые исключены с помощью свойства цели <code>EXCLUDE_FROM_ALL</code> или свойства каталога <code>EXCLUDE_FROM_ALL</code>. Имя <code>ALL_BUILD</code> используется для этой цели для генераторов Xcode и Visual Studio.</li>
                <li><strong>help</strong> - Перечисляет доступные цели для сборки. Эта цель доступна при использовании генератора Unix Makefiles или Ninja, и точный вывод зависит от инструмента.</li>
                <li><strong>clean</strong> - Удаляет собранные объектные файлы и другие выходные файлы. Генераторы на основе Makefile создают цель clean для каждого каталога, чтобы можно было очистить отдельный каталог. Инструмент Ninja предоставляет собственную детализированную систему <code>-t clean</code>.</li>
                <li><strong>test</strong> - Запускает тесты. Эта цель доступна только в том случае, если файлы CMake предоставляют тесты на основе CTest. См. также <a href="#running-tests">Запуск тестов</a>.</li>
                <li><strong>install</strong> - Устанавливает программное обеспечение. Эта цель доступна только в том случае, если программное обеспечение определяет правила установки с помощью команды <code>install()</code>. См. также <a href="#software-installation">Установка программного обеспечения</a>.</li>
                <li><strong>package</strong> - Создает бинарный пакет. Эта цель доступна только в том случае, если файлы CMake предоставляют пакеты на основе CPack.</li>
                <li><strong>package_source</strong> - Создает исходный пакет. Эта цель доступна только в том случае, если файлы CMake предоставляют пакеты на основе CPack.</li>
            </ul>
        
            <p>Для систем на основе Makefile предоставляются варианты бинарных целевых сборок с префиксом <code>/fast</code>. Варианты <code>/fast</code> используются для сборки указанной цели без учета зависимостей. Зависимости не проверяются и не пересобираются, если они устарели. Генератор Ninja достаточно быстр для проверки зависимостей, поэтому такие цели не предоставляются для этого генератора.</p>
        
            <p>Системы на основе Makefile также предоставляют целевые сборки для предварительной обработки, сборки и компиляции отдельных файлов в конкретном каталоге.</p>
        
            <pre><code>$make foo.cpp.i<br>$make foo.cpp.s<br>&make foo.cpp.o</code></pre>
        
            <p>Расширение файла встроено в имя цели, поскольку другой файл с таким же именем, но с другим расширением может существовать. Тем не менее, предоставляются и целевые сборки без расширения файла.</p>
        
            <pre><code>$make foo.i<br>$code>$make foo.s<br>$make foo.o</code></pre>
        
            <p>В системах сборки, содержащих <code>foo.c</code> и <code>foo.cpp</code>, сборка цели <code>foo.i</code> будет предварительно обрабатывать оба файла.</p>
        
            <h4 class="section-title">Указание Программы Сборки</h4>

            <p>Программа, вызываемая в режиме <code>--build</code>, определяется переменной <code>CMAKE_MAKE_PROGRAM</code>. Для большинства генераторов конкретную программу настраивать не нужно.</p>
        
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Генератор</th>
                        <th>Программа сборки по умолчанию</th>
                        <th>Альтернативы</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>XCode</td>
                        <td>xcodebuild</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Unix Makefiles</td>
                        <td>make</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>NMake Makefiles</td>
                        <td>nmake</td>
                        <td>jom</td>
                    </tr>
                    <tr>
                        <td>NMake Makefiles JOM</td>
                        <td>jom</td>
                        <td>nmake</td>
                    </tr>
                    <tr>
                        <td>MinGW Makefiles</td>
                        <td>mingw32-make</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>MSYS Makefiles</td>
                        <td>make</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Ninja</td>
                        <td>ninja</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Visual Studio</td>
                        <td>msbuild</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Watcom WMake</td>
                        <td>wmake</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        
            <p>Инструмент <code>jom</code> способен читать makefile'ы в стиле NMake и выполнять сборку параллельно, в то время как инструмент <code>nmake</code> всегда выполняет сборку последовательно. После генерации с помощью генератора NMake Makefiles пользователь может запустить <code>jom</code> вместо <code>nmake</code>. Режим <code>--build</code> также будет использовать <code>jom</code>, если <code>CMAKE_MAKE_PROGRAM</code> был установлен в <code>jom</code> при использовании генератора NMake Makefiles, а для удобства предоставляется генератор NMake Makefiles JOM для поиска <code>jom</code> обычным способом и использования его в качестве <code>CMAKE_MAKE_PROGRAM</code>. Для полноты, <code>nmake</code> является альтернативным инструментом, который может обрабатывать вывод генератора NMake Makefiles JOM, но использование его будет менее эффективно.</p>
        
            <h2 id="setup" class="section-title">Установка Программного Обеспечения</h2>
        
            <p>Переменная <code>CMAKE_INSTALL_PREFIX</code> может быть установлена в кэше CMake для указания места установки предоставленного программного обеспечения. Если предоставленное программное обеспечение имеет правила установки, указанные с помощью команды <code>install()</code>, они установят артефакты в этот префикс. В Windows место установки по умолчанию соответствует системному каталогу ProgramFiles, который может быть специфичным для архитектуры. На Unix-хостах, по умолчанию, используется каталог <code>/usr/local</code>.</p>
        
            <p>Переменная <code>CMAKE_INSTALL_PREFIX</code> всегда относится к префиксу установки в целевой файловой системе.</p>
        
            <p>В сценариях кросс-компиляции или упаковки, где sysroot является только для чтения или должен оставаться нетронутым, переменная <code>CMAKE_STAGING_PREFIX</code> может быть установлена в место, куда фактически будут установлены файлы.</p>
        
            <pre><code>$cmake .. -DCMAKE_INSTALL_PREFIX=/usr/local \<br>          -DCMAKE_SYSROOT=$HOME/root \<br>          -DCMAKE_STAGING_PREFIX=/tmp/package<br>$cmake --build .<br>$cmake --build . --target install</code></pre>
        
            <p>Результатом будут файлы, установленные в такие пути, как <code>/tmp/package/lib/libfoo.so</code> на хост-машине. Местоположение <code>/usr/local</code> на хост-машине не затронуто.</p>
        
            <p>Некоторые предоставленные программные обеспечения могут определять правила удаления, но CMake по умолчанию не генерирует такие правила самостоятельно.</p>
        
            <h2 id="test" class="section-title">Запуск Тестов</h2>
        
            <p>Инструмент <code>ctest(1)</code> поставляется с дистрибутивом CMake для выполнения предоставленных тестов и отчетности результатов. Цель теста <code>test</code> предоставляется для запуска всех доступных тестов, но инструмент <code>ctest(1)</code> позволяет более детально контролировать, какие тесты запускать, как их запускать и как сообщать о результатах. Выполнение <code>ctest(1)</code> в каталоге сборки эквивалентно запуску цели теста:</p>
        
            <pre><code>$ctest</code></pre>
        
            <p>Регулярное выражение может быть передано для запуска только тех тестов, которые соответствуют выражению. Чтобы запустить только тесты с Qt в имени:</p>
        
            <pre><code>$ctest -R Qt</code></pre>
        
            <p>Тесты также могут быть исключены с помощью регулярного выражения. Чтобы запустить только тесты без Qt в имени:</p>
        
            <pre><code>$ctest -E Qt</code></pre>
        
            <p>Тесты можно запускать параллельно, передав аргументы <code>-j</code> в <code>ctest(1)</code>:</p>
        
            <pre><code>$ctest -R Qt -j8</code></pre>
        
            <p>Переменная среды <code>CTEST_PARALLEL_LEVEL</code> может быть установлена альтернативно, чтобы избежать необходимости передавать <code>-j</code>.</p>
        
            <p>По умолчанию <code>ctest(1)</code> не выводит результат тестов. Аргумент командной строки <code>-V</code> (или <code>--verbose</code>) включает режим подробного вывода, чтобы печатать результат всех тестов. Опция <code>--output-on-failure</code> выводит результат тестов только для неудачных тестов. Переменная среды <code>CTEST_OUTPUT_ON_FAILURE</code> может быть установлена в 1 как альтернатива передаче опции <code>--output-on-failure</code> в <code>ctest(1)</code>.</p>
        
        </div>
    </div>
</body>

<footer>
    <div class="container-fluid bg-primary text-white py-2">
        <div class="row align-items-center">
            <div class="col-auto">
                <img src="../img/cmake-logo-16.png" alt="Logo" class="img-fluid" style="max-height: 40px;">
            </div>
            <div class="col">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb bg-primary text-white mb-0">
                        <li class="breadcrumb-item"><a href="../index.html" class="text-white">Документация</a></li>
                        <li class="breadcrumb-item"><a href="#" class="text-white">Руководства по взаимодействию с
                                пользователем</a></li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</footer>

<script src="../js/jquery-3.5.1.min.js"></script>
<script src="../js/popper.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/scripts.js"></script>

</html>